namespace = z_performance
#_[on_game_start/万用初始化]
#_[独立版_开局提示/独立版_modmenu]
#_[自动循环]




#_[on_game_start]
event = {
	id = z_performance.12
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = z_performance_installed	#_mod activited
	#	set_global_flag = z_performance_always		#_default
	#	set_global_flag = z_pf_uep_check_disabled
		set_global_flag = z_pf_job_check_full		#_default
		set_global_flag = z_pf_flg_glbl_demote_noai
		#_隐藏星球决策
		every_country = {
			limit = { is_ai = no }
			set_country_flag = z_pf_flg_cntr_hide_dec
		}
		random_country = {
			limit = { is_ai = no }
			country_event = { id = z_performance.10  days = 11 random = 4  }
		}
	}
}
###_[万用初始化]
country_event = {
	id = z_performance.101
	hide_window = yes
	fire_only_once = yes
	trigger = { is_ai = no }
	mean_time_to_happen = { days = 23 }
	
	immediate = {
		if = {
			limit = { NOT = { has_global_flag = z_performance_installed } }
			set_global_flag = z_performance_installed
			
		#	set_global_flag = z_performance_always
		#	remove_global_flag = z_performance_high
		#	remove_global_flag = z_performance_mid
		#	remove_global_flag = z_performance_low
		#	remove_global_flag = z_performance_never
		#	set_global_flag = z_pf_uep_check_disabled
			#_检测频率
			remove_global_flag = z_pf_frequency_low
			remove_global_flag = z_pf_frequency_high
			#_工作检测
			remove_global_flag = z_pf_flg_glbl_job_disable
			remove_global_flag = z_pf_flg_glbl_job_automatic
			#_阶层流动
			set_global_flag = z_pf_job_check_full
			#_自动降级
			remove_global_flag = z_pf_flg_glbl_demote
			set_global_flag = z_pf_flg_glbl_demote_noai
			#_隐藏星球决策
			every_country = {
				limit = { is_ai = no }
				set_country_flag = z_pf_flg_cntr_hide_dec
			}
			random_country = {
				limit = { is_ai = no }
				country_event = { id = z_performance.10  days = 11 random = 4  }
			}
		}
	}
}




#_[独立版_开局提示]
country_event = {
	id = z_performance.10
	title = z_performance_start_title
	desc = z_performance_start_title_desc
	picture = GFX_evt_z_performance
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		NOT = { has_global_flag = z_modmenu_installed }		#_只有在无mod面板时触发
	}
	
	#_工作检测-原版
	option = {
		name = z_performance.11.r1
		custom_tooltip = z_performance.11.r1.tooltip
		trigger = {
			NOR = {
				has_global_flag = z_pf_flg_glbl_job_disable
				has_global_flag = z_pf_flg_glbl_job_automatic
			}
		}
		hidden_effect = {
			set_global_flag = z_pf_flg_glbl_job_disable
			country_event = { id = z_performance.10 }
		}
	}
	#_工作检测-关闭
	option = {
		name = z_performance.11.r2
		custom_tooltip = z_performance.11.r2.tooltip
		trigger = { has_global_flag = z_pf_flg_glbl_job_disable }
		hidden_effect = {
			remove_global_flag = z_pf_flg_glbl_job_disable
			set_global_flag = z_pf_flg_glbl_job_automatic
			country_event = { id = z_performance.10 }
		}
	}
	#_工作检测-自动
	option = {
		name = z_performance.11.r3
		custom_tooltip = z_performance.11.r3.tooltip
		trigger = { has_global_flag = z_pf_flg_glbl_job_automatic }
		hidden_effect = {
			remove_global_flag = z_pf_flg_glbl_job_automatic
			country_event = { id = z_performance.10 }
		}
	}
	
	#_阶层流动
	option = {
		name = z_performance.10.p1
		custom_tooltip = z_performance.10.p1.tooltip
		trigger = { has_global_flag = z_pf_job_check_full }	#_z_performance_always
		hidden_effect = {
			remove_global_flag = z_pf_job_check_full
			country_event = { id = z_performance.10 }
		}
	}
	#_no 阶层流动
	option = {
		name = z_performance.10.p2
		custom_tooltip = z_performance.10.p2.tooltip
		trigger = { NOT = { has_global_flag = z_pf_job_check_full } }	#_z_performance_always
		hidden_effect = {
			set_global_flag = z_pf_job_check_full
			country_event = { id = z_performance.10 }
		}
	}
	
	#_excess pops
	option = {
		name = z_performance.10.c
		custom_tooltip = z_performance.10.c.tooltip
		trigger = { has_global_flag = z_pf_heup_automatic_on }
		hidden_effect = {
			remove_global_flag = z_pf_heup_automatic_on
			country_event = { id = z_performance.10 }
		}
	}
	#_no optimization
	option = {
		name = z_performance.10.d
		custom_tooltip = z_performance.10.d.tooltip
		trigger = { NOT = { has_global_flag = z_pf_heup_automatic_on } }
		hidden_effect = {
			set_global_flag = z_pf_heup_automatic_on
			country_event = { id = z_performance.10 }
		}
	}
	
	#_完成设置
	option = {
		name = z_performance.10.z
		hidden_effect = {
			#_设置完成
			if = {
				limit = { has_global_flag = z_pf_heup_automatic_on }
				#_处理density
				remove_global_flag = z_pf_frequency_low
				remove_global_flag = z_pf_frequency_high
				#_处理方式
				remove_global_flag = z_pf_excess_ai_resettle
				remove_global_flag = z_pf_excess_ai_resettle_kill
				remove_global_flag = z_pf_excess_ai_kill
				set_global_flag = z_pf_excess_pc_resettle
				remove_global_flag = z_pf_excess_pc_resettle_kill
				remove_global_flag = z_pf_excess_pc_kill
			}
		}
	}
}


#_[独立版_modmenu]
country_event = {
	id = z_performance.11
	title = z_performance_title
	#desc = z_performance_title_desc
	picture = GFX_evt_z_performance
	is_triggered_only = yes
	
	desc = {
		trigger = {
			#_总人口数
			success_text = {
				text = z_pf2_title_desc_pop_non
				check_variable = { which = z_galaxy_pop_var value = 0 }
			}
			success_text = {
				text = z_pf2_title_desc_pop
				check_variable = { which = z_galaxy_pop_var value > 0 }
			}
			#_失业人口数
			success_text = {
				text = z_pf2_title_desc_unemployed_non
				check_variable = { which = z_galaxy_pop_unemployed_var value = 0 }
			}
			success_text = {
				text = z_pf2_title_desc_unemployed
				check_variable = { which = z_galaxy_pop_unemployed_var value > 0 }
			}
			#_main
			success_text = {
				text = z_performance_title_desc
				has_global_flag = z_performance_installed
			}
		}
	}
	
	immediate = {
		set_variable = { which = z_galaxy_pop_var value = 0 }
		set_variable = { which = z_galaxy_pop_unemployed_var value = 0 }
		every_country = {
			limit = { num_pops > 0 }
			every_owned_pop = {
				if = {
					limit = { is_unemployed = yes }
					ROOT = {
						change_variable = { which = z_galaxy_pop_var value = 1 }
						change_variable = { which = z_galaxy_pop_unemployed_var value = 1 }
					}
				}
				else = {
					ROOT = { change_variable = { which = z_galaxy_pop_var value = 1 } }
				}
			}
		}
	}

	###_job checking and automatic degrade	######################################
	#_vanilla
#	option = {
#		name = z_performance.11.a
#		custom_tooltip = z_performance.11.a.tooltip
#		trigger = { has_global_flag = z_performance_always }
#		hidden_effect = {
#			remove_global_flag = z_performance_always
#			set_global_flag = z_performance_high
#			
#			country_event = { id = z_performance.11 }
#		}
#	}
	#_high
#	option = {
#		name = z_performance.11.b
#		custom_tooltip = z_performance.11.b.tooltip
#		trigger = { has_global_flag = z_performance_high }
#		hidden_effect = {
#			remove_global_flag = z_performance_high
#			set_global_flag = z_performance_mid
#			
#			country_event = { id = z_performance.11 }
#		}
#	}
	#_mid
#	option = {
#		name = z_performance.11.c
#		custom_tooltip = z_performance.11.c.tooltip
#		trigger = { has_global_flag = z_performance_mid }
#		hidden_effect = {
#			
#			remove_global_flag = z_performance_mid
#			set_global_flag = z_performance_low
#			
#			country_event = { id = z_performance.11 }
#		}
#	}
	#_low
#	option = {
#		name = z_performance.11.e
#		custom_tooltip = z_performance.11.e.tooltip
#		trigger = { has_global_flag = z_performance_low }
#		hidden_effect = {
#			remove_global_flag = z_performance_low
#			set_global_flag = z_performance_always
#			
#			country_event = { id = z_performance.11 }
#		}
#	}
	
	#_uep check
#	option = {
#		name = z_performance.11.j1
#		custom_tooltip = z_performance.11.j1.tooltip
#		trigger = { has_global_flag = z_pf_uep_check_disabled }
#		hidden_effect = {
#			remove_global_flag = z_pf_uep_check_disabled
#			country_event = { id = z_performance.11 }
#		}
#	}
#	option = {
#		name = z_performance.11.j2
#		custom_tooltip = z_performance.11.j2.tooltip
#		trigger = { NOT = { has_global_flag = z_pf_uep_check_disabled } }
#		hidden_effect = {
#			set_global_flag = z_pf_uep_check_disabled
#			country_event = { id = z_performance.11 }
#		}
#	}
	
	#_全局检测频率-中(默认)
	option = {
		name = z_performance.11.q1
		custom_tooltip = z_performance.11.q1.tooltip
        custom_gui = "z_mm_button_evt_option_normal"
		trigger = {
			NOR = {
				has_global_flag = z_pf_frequency_low
				has_global_flag = z_pf_frequency_high
			}
		}
		hidden_effect = {
			set_global_flag = z_pf_frequency_high
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	#_全局检测频率-高
	option = {
		name = z_performance.11.q2
		custom_tooltip = z_performance.11.q2.tooltip
        custom_gui = "z_mm_button_evt_option_normal"
		trigger = { has_global_flag = z_pf_frequency_high }
		hidden_effect = {
			remove_global_flag = z_pf_frequency_high
			set_global_flag = z_pf_frequency_low
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	#_全局检测频率-低
	option = {
		name = z_performance.11.q3
		custom_tooltip = z_performance.11.q3.tooltip
        custom_gui = "z_mm_button_evt_option_normal"
		trigger = { has_global_flag = z_pf_frequency_low }
		hidden_effect = {
			remove_global_flag = z_pf_frequency_low
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	
	#_工作检测-原版
	option = {
		name = z_performance.11.r1
		custom_tooltip = z_performance.11.r1.tooltip
		trigger = {
			NOR = {
				has_global_flag = z_pf_flg_glbl_job_disable
				has_global_flag = z_pf_flg_glbl_job_automatic
			}
		}
		hidden_effect = {
			set_global_flag = z_pf_flg_glbl_job_disable
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	#_工作检测-关闭
	option = {
		name = z_performance.11.r2
		custom_tooltip = z_performance.11.r2.tooltip
		trigger = { has_global_flag = z_pf_flg_glbl_job_disable }
		hidden_effect = {
			remove_global_flag = z_pf_flg_glbl_job_disable
			set_global_flag = z_pf_flg_glbl_job_automatic
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	#_工作检测-自动
	option = {
		name = z_performance.11.r3
		custom_tooltip = z_performance.11.r3.tooltip
		trigger = { has_global_flag = z_pf_flg_glbl_job_automatic }
		hidden_effect = {
			remove_global_flag = z_pf_flg_glbl_job_automatic
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	
	#_阶层变动---启用
	option = {
		name = z_performance.11.p1
		custom_tooltip = z_performance.11.p1.tooltip
		trigger = { has_global_flag = z_pf_job_check_full }
		hidden_effect = {
			remove_global_flag = z_pf_job_check_full
			country_event = { id = z_performance.11 }
		}
	}
	#_阶层变动---禁用
	option = {
		name = z_performance.11.p2
		custom_tooltip = z_performance.11.p2.tooltip
		trigger = { NOT = { has_global_flag = z_pf_job_check_full } }
		hidden_effect = {
			set_global_flag = z_pf_job_check_full
			country_event = { id = z_performance.11 }
		}
	}
	
	#_degrade
	option = {
		name = z_performance.11.i1
		custom_tooltip = z_performance.11.i1.tooltip
		trigger = { has_global_flag = z_pf_flg_glbl_demote }
		hidden_effect = {
			remove_global_flag = z_pf_flg_glbl_demote
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.i2
		custom_tooltip = z_performance.11.i2.tooltip
		trigger = {
			NOR = {
				has_global_flag = z_pf_flg_glbl_demote
				has_global_flag = z_pf_flg_glbl_demote_noai
			}
		}
		hidden_effect = {
			set_global_flag = z_pf_flg_glbl_demote_noai
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.i3
		custom_tooltip = z_performance.11.i3.tooltip
		trigger = { has_global_flag = z_pf_flg_glbl_demote_noai }
		hidden_effect = {
			remove_global_flag = z_pf_flg_glbl_demote_noai
			set_global_flag = z_pf_flg_glbl_demote
			country_event = { id = z_performance.11 }
		}
	}
	
	###_handle excess pops	######################################
	#_开
	option = {
		name = z_performance.11.n1
		custom_tooltip = z_performance.11.n1.tooltip
        custom_gui = "z_mm_button_evt_option_orange"
		trigger = {
			has_global_flag = z_pf_heup_automatic_on
		}
		hidden_effect = {
			remove_global_flag = z_pf_heup_automatic_on
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	#_关
	option = {
		name = z_performance.11.n2
		custom_tooltip = z_performance.11.n2.tooltip
        custom_gui = "z_mm_button_evt_option_orange"
		trigger = { NOT = { has_global_flag = z_pf_heup_automatic_on } }
		hidden_effect = {
			set_global_flag = z_pf_heup_automatic_on
			country_event = { id = z_pf_modmenu.11 }
		}
	}
	
	#_handle excess pops-AI
	option = {
		name = z_performance.11.k1
		custom_tooltip = z_performance.11.k1.tooltip
		trigger = {
			NOR = {
				has_global_flag = z_pf_excess_ai_resettle
				has_global_flag = z_pf_excess_ai_resettle_kill
				has_global_flag = z_pf_excess_ai_kill
			}
		}
		hidden_effect = {
			set_global_flag = z_pf_excess_ai_resettle
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.k2
		custom_tooltip = z_performance.11.k2.tooltip
		trigger = { has_global_flag = z_pf_excess_ai_resettle }
		hidden_effect = {
			remove_global_flag = z_pf_excess_ai_resettle
			set_global_flag = z_pf_excess_ai_resettle_kill
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.k3
		custom_tooltip = z_performance.11.k3.tooltip
		trigger = { has_global_flag = z_pf_excess_ai_resettle_kill }
		hidden_effect = {
			remove_global_flag = z_pf_excess_ai_resettle_kill
			set_global_flag = z_pf_excess_ai_kill
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.k4
		custom_tooltip = z_performance.11.k4.tooltip
		trigger = { has_global_flag = z_pf_excess_ai_kill }
		hidden_effect = {
			remove_global_flag = z_pf_excess_ai_kill
			country_event = { id = z_performance.11 }
		}
	}
	
	#_handle excess pops-PC
	option = {
		name = z_performance.11.l1
		custom_tooltip = z_performance.11.l1.tooltip
		trigger = {
			NOR = {
				has_global_flag = z_pf_excess_pc_resettle
				has_global_flag = z_pf_excess_pc_resettle_kill
				has_global_flag = z_pf_excess_pc_kill
			}
		}
		hidden_effect = {
			set_global_flag = z_pf_excess_pc_resettle
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.l2
		custom_tooltip = z_performance.11.l2.tooltip
		trigger = { has_global_flag = z_pf_excess_pc_resettle }
		hidden_effect = {
			remove_global_flag = z_pf_excess_pc_resettle
			set_global_flag = z_pf_excess_pc_resettle_kill
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.l3
		custom_tooltip = z_performance.11.l3.tooltip
		trigger = { has_global_flag = z_pf_excess_pc_resettle_kill }
		hidden_effect = {
			remove_global_flag = z_pf_excess_pc_resettle_kill
			set_global_flag = z_pf_excess_pc_kill
			country_event = { id = z_performance.11 }
		}
	}
	option = {
		name = z_performance.11.l4
		custom_tooltip = z_performance.11.l4.tooltip
		trigger = { has_global_flag = z_pf_excess_pc_kill }
		hidden_effect = {
			remove_global_flag = z_pf_excess_pc_kill
			country_event = { id = z_performance.11 }
		}
	}
	
	#_handle excess pops-resettle cap
	option = {#_默认
		name = z_performance.11.m1
		custom_tooltip = z_performance.11.m.tooltip
		trigger = {
			NOR = {
				has_global_flag = z_pf_flg_cntr_heup_var_low
				has_global_flag = z_pf_flg_cntr_heup_var_high
			}
		}
		hidden_effect = {
			set_global_flag = z_pf_flg_cntr_heup_var_low
			country_event = { id = z_performance.11 }
		}
	}
	option = {#_少
		name = z_performance.11.m2
		custom_tooltip = z_performance.11.m.tooltip
		trigger = { has_global_flag = z_pf_flg_cntr_heup_var_low }
		hidden_effect = {
			remove_global_flag = z_pf_flg_cntr_heup_var_low
			set_global_flag = z_pf_flg_cntr_heup_var_high
			country_event = { id = z_performance.11 }
		}
	}
	option = {#_多
		name = z_performance.11.m3
		custom_tooltip = z_performance.11.m.tooltip
		trigger = { has_global_flag = z_pf_flg_cntr_heup_var_high }
		hidden_effect = {
			remove_global_flag = z_pf_flg_cntr_heup_var_high
			country_event = { id = z_performance.11 }
		}
	}
	
	
	#_restart
#	option = {
#		name = z_performance.11.f
#		custom_tooltip = z_performance.11.f.tooltip
#		trigger = { has_global_flag = z_performance_never }
#		hidden_effect = {
#			remove_global_flag = z_performance_never
#			set_global_flag = z_performance_high
#			
#			country_event = { id = z_performance.11 }
#		}
#	}
	#_shut down
#	option = {
#		name = z_performance.11.f1
#		custom_tooltip = z_performance.11.f1.tooltip
#		trigger = { NOT = { has_global_flag = z_performance_never } }
#		hidden_effect = {
#			remove_global_flag = z_performance_always
#			remove_global_flag = z_allow_job_check		#_全人口检测
#			remove_global_flag = z_performance_high
#			remove_global_flag = z_performance_mid
#			remove_global_flag = z_performance_low
#			set_global_flag = z_performance_never
#			country_event = { id = z_performance.11 }
#		}
#	}
	
	#_Debug-default
	option = {
		name = z_performance.11.f2
		custom_tooltip = z_performance.11.f2.tooltip
		hidden_effect = {
		#	set_global_flag = z_performance_always
		#	remove_global_flag = z_performance_high
		#	remove_global_flag = z_performance_mid
		#	remove_global_flag = z_performance_low
		#	remove_global_flag = z_performance_never
		#	set_global_flag = z_pf_uep_check_disabled
			#_检测频率
			remove_global_flag = z_pf_frequency_low
			remove_global_flag = z_pf_frequency_high
			#_工作检测
			remove_global_flag = z_pf_flg_glbl_job_disable
			remove_global_flag = z_pf_flg_glbl_job_automatic
			#_阶层流动
			set_global_flag = z_pf_job_check_full
			#_自动降级
			remove_global_flag = z_pf_flg_glbl_demote
			set_global_flag = z_pf_flg_glbl_demote_noai
			#_resettle
			remove_global_flag = z_pf_heup_automatic_on
			remove_global_flag = z_pf_excess_ai_resettle
			remove_global_flag = z_pf_excess_ai_resettle_kill
			remove_global_flag = z_pf_excess_ai_kill
			remove_global_flag = z_pf_excess_pc_resettle
			remove_global_flag = z_pf_excess_pc_resettle_kill
			remove_global_flag = z_pf_excess_pc_kill
			remove_global_flag = z_pf_flg_cntr_heup_var_low
			remove_global_flag = z_pf_flg_cntr_heup_var_high
			country_event = { id = z_performance.11 }
		}
	}
	#_resettle best setting
	option = {
		name = z_performance.11.f3
		custom_tooltip = z_performance.11.f3.tooltip
		allow = {
			hidden_trigger = {
				NAND = {
					has_global_flag = z_pf_heup_automatic_on
					has_global_flag = z_pf_excess_ai_kill
					has_global_flag = z_pf_excess_pc_resettle
				}
			}
		}
		hidden_effect = {
			#_处理density
			remove_global_flag = z_pf_frequency_low
			remove_global_flag = z_pf_frequency_high
			#_开启heup
			set_global_flag = z_pf_heup_automatic_on
			#_处理方式
			remove_global_flag = z_pf_excess_ai_resettle
			remove_global_flag = z_pf_excess_ai_resettle_kill
			set_global_flag = z_pf_excess_ai_kill
			set_global_flag = z_pf_excess_pc_resettle
			remove_global_flag = z_pf_excess_pc_resettle_kill
			remove_global_flag = z_pf_excess_pc_kill
			#_每次数目
			remove_global_flag = z_pf_flg_cntr_heup_var_low
			remove_global_flag = z_pf_flg_cntr_heup_var_high
			country_event = { id = z_performance.11 }
		}
	}
	
	#_cancel
	option = {
		hidden_effect = {
			z_mm_unlock_setting_panel = yes		#_z mm
			set_variable = { which = z_galaxy_pop_var value = 0 }
			set_variable = { which = z_galaxy_pop_unemployed_var value = 0 }
		}
		name = z_performance.11.h
		custom_tooltip = z_performance.11.h.tooltip
	}
}








###_[自动循环]	[id=13]	#############################
#_glbl_flg	[z_pf_flg_glbl_demote][z_pf_flg_glbl_demote_noai]	自动降级
#_glbl_flg	[z_pf_flg_glbl_job_disable][z_pf_flg_glbl_job_automatic]	工作检测
#_glbl_flg	[z_pf_cd_glbl_automatic]
#_plnt_eft	[z_pf_eft_plnt_pop_demote]

#_[on_monthly_pulse]	自动循环_CD/自动人口迁移/自动降级/job检测自动执行
event = {
	id = z_performance.13
	hide_window = yes
	is_triggered_only = yes
	trigger = { NOT = { has_global_flag = z_pf_cd_glbl_automatic } }
	
	immediate = {
		#_[自动循环_CD]	3/!6/9
		z_pf_eft_global_cd = yes
		#_[自动人口迁移]
		if = {
			limit = { has_global_flag = z_pf_heup_automatic_on }
			#_随机玩家开始执行
			random_country = {
				limit = {
					is_ai = no
					NOT = { has_country_flag = z_pr_flg_cntr_1 }	#_[产业革命]non
				}
				country_event = { id = z_pf_heup.1 }
			}
		}
		#_[自动降级]
		if =  {#_ALL
			limit = { has_global_flag = z_pf_flg_glbl_demote }
			every_country = {
				limit = { z_pf_trgr_cntr_valid = yes }		#_country_type
				every_owned_planet = {
					limit = {
						is_colony = yes
					#	free_jobs > 0
					}
					planet_event = { id = z_performance.131 days = 1 random = 2 }
				}
			}
		}
		else_if = {#_PC
			limit = { has_global_flag = z_pf_flg_glbl_demote_noai }
			every_country = {
				limit = { is_ai = no }
				every_owned_planet = {
					limit = {
						is_colony = yes
					#	free_jobs > 0
					}
					planet_event = { id = z_performance.131 days = 2 random = 1 }
				}
			}
		}
		#_[job检测自动执行]
		if =  {
			limit = {
				has_global_flag = z_pfc_installed	#_[人口管理_万用兼容]安装
				has_global_flag = z_pf_flg_glbl_job_automatic
			}
			every_country = {
				limit = { z_pf_trgr_cntr_valid = yes }		#_[country_type/产业革命_non]
				every_owned_planet = {
					limit = {
						is_colony = yes
						num_pops > 0
						free_jobs > 0
						count_owned_pops = {#_闲人
							count > 0
							limit = { is_unemployed = yes }
						}
					}
					planet_event = { id = z_performance.132 days = 3 random = 4 }
				}
			}
		}
	}
}
#_[自动降级]
planet_event = {#_自动降级 添加检测trigger
	id = z_performance.131
	hide_window = yes
	is_triggered_only = yes
	immediate = { z_pf_eft_plnt_pop_demote = yes }		#_degrade	直接执行无判断
}
#_自动循环---工作检测-前置
planet_event = {
	id = z_performance.132
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		set_timed_planet_flag = { flag = z_pf_flg_plnt_job_checker days = 2 }
		planet_event = { id = z_performance.133 days = 1 }
	}
}
#_自动循环---工作检测-执行
planet_event = {
	id = z_performance.133
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		add_modifier = { modifier = z_pf_mod_pop_check days = 1 }			#_[debug] 最大区划+1
		z_pf_eft_job_check_district = yes
	}
}
planet_event = {#_星球毁灭检测
	id = z_performance.134
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = z_performance.133 days = 1 }
	}
}




#_失业人口检测 [人口增加/建筑变动]	<暂时禁用>
planet_event = {
	id = z_performance.14
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		is_colony = yes
		num_pops > 0
		NOR = {
			has_planet_flag = z_pf_uep_checking_cd		#_CD
			free_jobs < 1		#_空职位
			count_owned_pops = {#_失业人口
				count = 0
				limit = { is_unemployed = yes }
			}
			has_global_flag = z_pf_uep_check_disabled	#_失业检测开关
		}
	}
	
	immediate = {
		z_pf_eft_plnt_pop_demote = yes		#_degrade	直接执行无判断
		set_timed_planet_flag = { flag = z_pf_uep_checking_cd days = 10 }	#_CD
		set_timed_planet_flag = { flag = z_pf_flg_plnt_job_uep days = 2 }	#_unemployed trigger
		planet_event = { id = z_performance.141 days = 1 }
	}
}
planet_event = {#_district 检测
	id = z_performance.141
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		add_modifier = { modifier = z_pf_mod_pop_check days = 1 }			#_[debug] 最大区划+1
		z_pf_eft_job_check_district = yes
	}
}




#_手动检测---触发trigger
country_event = {
	id = z_performance.6
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		#_添加星球effect
		every_owned_planet = {
			limit = {
				is_colony = yes
				num_pops > 0
			}
			#_自动降级
			if = {
				limit = {
					OR = {
						has_global_flag = z_pf_flg_glbl_demote
						AND = {
							owner = { is_ai = no }		#_pc
							has_global_flag = z_pf_flg_glbl_demote_noai
						}
					}
				}
				z_pf_eft_plnt_pop_demote = yes	#_degrade	直接执行无判断
			}
			#_工作检测
			if = {
				limit = { free_jobs > 0 }
				set_timed_planet_flag = { flag = z_pf_flg_plnt_job_checker days = 2 }	#_full pops trigger
				planet_event = { id = z_performance.133 days = 1 }
			}
		}
	}
}




#_[mid term] high density to mid
country_event = {
	id = z_performance.7
	hide_window = yes
	fire_only_once = yes
	mean_time_to_happen = { years = 2 }
	trigger = {
		is_ai = no
		mid_game_years_passed >= -1
	}
	
	immediate = {
		if = {
			limit = { has_global_flag = z_pf_frequency_high }
			remove_global_flag = z_pf_frequency_high
		}
	}
}










###_[2.5] old	#####################################################################################
#_always	[26/26]/per month
event = {
	id = z_performance.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = z_performance_always
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 4 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 30 }
	}
}
#_high	[3/5]/per month
event = {
	id = z_performance.2
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = z_performance_high
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 22 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 25 }
	}
}
#_mid	[1/3]/per month
event = {
	id = z_performance.3
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = z_performance_mid
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 26 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 27 }
	}
}
#_low	[1/3]/every 2 months
event = {
	id = z_performance.4
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = z_allow_job_check2 }
		has_global_flag = z_performance_low
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 56 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 57 }
	}
}
#_never	[0/3]/every 2 months
event = {
	id = z_performance.5
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = z_allow_job_check2 }
		has_global_flag = z_performance_never
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 57 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 57 }
	}
}


#_手动检测-old
#country_event = {
#	id = z_performance.6
#	hide_window = yes
#	is_triggered_only = yes
#	
#	immediate = {
#		set_timed_global_flag = { flag = z_manual_job_check days = 23 }
#	}
#}